!function(e){function t(t){for(var r,o,i=t[0],a=t[1],s=t[2],c=0,u=[];c<i.length;c++)o=i[c],Object.prototype.hasOwnProperty.call(x,o)&&x[o]&&u.push(x[o][0]),x[o]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(M&&M(t);u.length;)u.shift()();return _.push.apply(_,s||[]),n()}function n(){for(var e,t=0;t<_.length;t++){for(var n=_[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==x[i]&&(r=!1)}r&&(_.splice(t--,1),e=R(R.s=n[0]))}return e}var r=window.webpackHotUpdate;window.webpackHotUpdate=function(e,t){!function(e,t){if(!O[e]||!w[e])return;for(var n in w[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--b&&0===g&&E()}(e,t),r&&r(e,t)};var o,i=!0,a="9923ce797e2170677805",s=1e4,c={},u=[],l=[];function h(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:k,apply:T,status:function(e){if(!e)return p;f.push(e)},addStatusHandler:function(e){f.push(e)},removeStatusHandler:function(e){var t=f.indexOf(e);t>=0&&f.splice(t,1)},data:c[e]};return o=void 0,t}var f=[],p="idle";function d(e){p=e;for(var t=0;t<f.length;t++)f[t].call(null,e)}var y,m,v,b=0,g=0,j={},w={},O={};function P(e){return+e+""===e?+e:e}function k(e){if("idle"!==p)throw new Error("check() is only allowed in idle status");return i=e,d("check"),(t=s,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,o=R.p+""+a+".hot-update.json";r.open("GET",o,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return d("idle"),null;w={},j={},O=e.c,v=e.h,d("prepare");var t=new Promise((function(e,t){y={resolve:e,reject:t}}));for(var n in m={},x)D(n);return"prepare"===p&&0===g&&0===b&&E(),t}));var t}function D(e){O[e]?(w[e]=!0,b++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=R.p+""+e+"."+a+".hot-update.js",document.head.appendChild(t)}(e)):j[e]=!0}function E(){d("ready");var e=y;if(y=null,e)if(i)Promise.resolve().then((function(){return T(i)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(P(n));e.resolve(t)}}function T(t){if("ready"!==p)throw new Error("apply() is only allowed in ready status");var n,r,o,i,s;function l(e){for(var t=[e],n={},r=t.map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),a=o.id,s=o.chain;if((i=S[a])&&!i.hot._selfAccepted){if(i.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:a};if(i.hot._main)return{type:"unaccepted",chain:s,moduleId:a};for(var c=0;c<i.parents.length;c++){var u=i.parents[c],l=S[u];if(l){if(l.hot._declinedDependencies[a])return{type:"declined",chain:s.concat([u]),moduleId:a,parentId:u};-1===t.indexOf(u)&&(l.hot._acceptedDependencies[a]?(n[u]||(n[u]=[]),h(n[u],[a])):(delete n[u],t.push(u),r.push({chain:s.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var f={},y=[],b={},g=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var j in m)if(Object.prototype.hasOwnProperty.call(m,j)){var w;s=P(j);var k=!1,D=!1,E=!1,T="";switch((w=m[j]?l(s):{type:"disposed",moduleId:j}).chain&&(T="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(k=new Error("Aborted because of self decline: "+w.moduleId+T));break;case"declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(k=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+T));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(w),t.ignoreUnaccepted||(k=new Error("Aborted because "+s+" is not accepted"+T));break;case"accepted":t.onAccepted&&t.onAccepted(w),D=!0;break;case"disposed":t.onDisposed&&t.onDisposed(w),E=!0;break;default:throw new Error("Unexception type "+w.type)}if(k)return d("abort"),Promise.reject(k);if(D)for(s in b[s]=m[s],h(y,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,s)&&(f[s]||(f[s]=[]),h(f[s],w.outdatedDependencies[s]));E&&(h(y,[w.moduleId]),b[s]=g)}var _,C=[];for(r=0;r<y.length;r++)s=y[r],S[s]&&S[s].hot._selfAccepted&&b[s]!==g&&C.push({module:s,errorHandler:S[s].hot._selfAccepted});d("dispose"),Object.keys(O).forEach((function(e){!1===O[e]&&function(e){delete x[e]}(e)}));for(var A,N,M=y.slice();M.length>0;)if(s=M.pop(),i=S[s]){var G={},F=i.hot._disposeHandlers;for(o=0;o<F.length;o++)(n=F[o])(G);for(c[s]=G,i.hot.active=!1,delete S[s],delete f[s],o=0;o<i.children.length;o++){var I=S[i.children[o]];I&&((_=I.parents.indexOf(s))>=0&&I.parents.splice(_,1))}}for(s in f)if(Object.prototype.hasOwnProperty.call(f,s)&&(i=S[s]))for(N=f[s],o=0;o<N.length;o++)A=N[o],(_=i.children.indexOf(A))>=0&&i.children.splice(_,1);for(s in d("apply"),a=v,b)Object.prototype.hasOwnProperty.call(b,s)&&(e[s]=b[s]);var H=null;for(s in f)if(Object.prototype.hasOwnProperty.call(f,s)&&(i=S[s])){N=f[s];var z=[];for(r=0;r<N.length;r++)if(A=N[r],n=i.hot._acceptedDependencies[A]){if(-1!==z.indexOf(n))continue;z.push(n)}for(r=0;r<z.length;r++){n=z[r];try{n(N)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:s,dependencyId:N[r],error:e}),t.ignoreErrored||H||(H=e)}}}for(r=0;r<C.length;r++){var L=C[r];s=L.module,u=[s];try{R(s)}catch(e){if("function"==typeof L.errorHandler)try{L.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:s,error:n,originalError:e}),t.ignoreErrored||H||(H=n),H||(H=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:s,error:e}),t.ignoreErrored||H||(H=e)}}return H?(d("fail"),Promise.reject(H)):(d("idle"),new Promise((function(e){e(y)})))}var S={},x={0:0},_=[];function R(t){if(S[t])return S[t].exports;var n=S[t]={i:t,l:!1,exports:{},hot:h(t),parents:(l=u,u=[],l),children:[]};return e[t].call(n.exports,n,n.exports,function(e){var t=S[e];if(!t)return R;var n=function(n){return t.hot.active?(S[n]?-1===S[n].parents.indexOf(e)&&S[n].parents.push(e):(u=[e],o=n),-1===t.children.indexOf(n)&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),u=[]),R(n)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return R[e]},set:function(t){R[e]=t}}};for(var i in R)Object.prototype.hasOwnProperty.call(R,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(n,i,r(i));return n.e=function(e){return"ready"===p&&d("prepare"),g++,R.e(e).then(t,(function(e){throw t(),e}));function t(){g--,"prepare"===p&&(j[e]||D(e),0===g&&0===b&&E())}},n.t=function(e,t){return 1&t&&(e=n(e)),R.t(e,-2&t)},n}(t)),n.l=!0,n.exports}R.m=e,R.c=S,R.d=function(e,t,n){R.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},R.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},R.t=function(e,t){if(1&t&&(e=R(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(R.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)R.d(n,r,function(t){return e[t]}.bind(null,r));return n},R.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return R.d(t,"a",t),t},R.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},R.p="/build",R.h=function(){return a};var C=window.webpackJsonp=window.webpackJsonp||[],A=C.push.bind(C);C.push=t,C=C.slice();for(var N=0;N<C.length;N++)t(C[N]);var M=A;_.push([664,1]),n()}({1586:function(e,t,n){var r={"./af":534,"./af.js":534,"./ar":535,"./ar-dz":536,"./ar-dz.js":536,"./ar-kw":537,"./ar-kw.js":537,"./ar-ly":538,"./ar-ly.js":538,"./ar-ma":539,"./ar-ma.js":539,"./ar-sa":540,"./ar-sa.js":540,"./ar-tn":541,"./ar-tn.js":541,"./ar.js":535,"./az":542,"./az.js":542,"./be":543,"./be.js":543,"./bg":544,"./bg.js":544,"./bm":545,"./bm.js":545,"./bn":546,"./bn.js":546,"./bo":547,"./bo.js":547,"./br":548,"./br.js":548,"./bs":549,"./bs.js":549,"./ca":550,"./ca.js":550,"./cs":551,"./cs.js":551,"./cv":552,"./cv.js":552,"./cy":553,"./cy.js":553,"./da":554,"./da.js":554,"./de":555,"./de-at":556,"./de-at.js":556,"./de-ch":557,"./de-ch.js":557,"./de.js":555,"./dv":558,"./dv.js":558,"./el":559,"./el.js":559,"./en-SG":560,"./en-SG.js":560,"./en-au":561,"./en-au.js":561,"./en-ca":562,"./en-ca.js":562,"./en-gb":563,"./en-gb.js":563,"./en-ie":564,"./en-ie.js":564,"./en-il":565,"./en-il.js":565,"./en-nz":566,"./en-nz.js":566,"./eo":567,"./eo.js":567,"./es":568,"./es-do":569,"./es-do.js":569,"./es-us":570,"./es-us.js":570,"./es.js":568,"./et":571,"./et.js":571,"./eu":572,"./eu.js":572,"./fa":573,"./fa.js":573,"./fi":574,"./fi.js":574,"./fo":575,"./fo.js":575,"./fr":576,"./fr-ca":577,"./fr-ca.js":577,"./fr-ch":578,"./fr-ch.js":578,"./fr.js":576,"./fy":579,"./fy.js":579,"./ga":580,"./ga.js":580,"./gd":581,"./gd.js":581,"./gl":582,"./gl.js":582,"./gom-latn":583,"./gom-latn.js":583,"./gu":584,"./gu.js":584,"./he":585,"./he.js":585,"./hi":586,"./hi.js":586,"./hr":587,"./hr.js":587,"./hu":588,"./hu.js":588,"./hy-am":589,"./hy-am.js":589,"./id":590,"./id.js":590,"./is":591,"./is.js":591,"./it":592,"./it-ch":593,"./it-ch.js":593,"./it.js":592,"./ja":594,"./ja.js":594,"./jv":595,"./jv.js":595,"./ka":596,"./ka.js":596,"./kk":597,"./kk.js":597,"./km":598,"./km.js":598,"./kn":599,"./kn.js":599,"./ko":600,"./ko.js":600,"./ku":601,"./ku.js":601,"./ky":602,"./ky.js":602,"./lb":603,"./lb.js":603,"./lo":604,"./lo.js":604,"./lt":605,"./lt.js":605,"./lv":606,"./lv.js":606,"./me":607,"./me.js":607,"./mi":608,"./mi.js":608,"./mk":609,"./mk.js":609,"./ml":610,"./ml.js":610,"./mn":611,"./mn.js":611,"./mr":612,"./mr.js":612,"./ms":613,"./ms-my":614,"./ms-my.js":614,"./ms.js":613,"./mt":615,"./mt.js":615,"./my":616,"./my.js":616,"./nb":617,"./nb.js":617,"./ne":618,"./ne.js":618,"./nl":619,"./nl-be":620,"./nl-be.js":620,"./nl.js":619,"./nn":621,"./nn.js":621,"./pa-in":622,"./pa-in.js":622,"./pl":623,"./pl.js":623,"./pt":624,"./pt-br":625,"./pt-br.js":625,"./pt.js":624,"./ro":626,"./ro.js":626,"./ru":627,"./ru.js":627,"./sd":628,"./sd.js":628,"./se":629,"./se.js":629,"./si":630,"./si.js":630,"./sk":631,"./sk.js":631,"./sl":632,"./sl.js":632,"./sq":633,"./sq.js":633,"./sr":634,"./sr-cyrl":635,"./sr-cyrl.js":635,"./sr.js":634,"./ss":636,"./ss.js":636,"./sv":637,"./sv.js":637,"./sw":638,"./sw.js":638,"./ta":639,"./ta.js":639,"./te":640,"./te.js":640,"./tet":641,"./tet.js":641,"./tg":642,"./tg.js":642,"./th":643,"./th.js":643,"./tl-ph":644,"./tl-ph.js":644,"./tlh":645,"./tlh.js":645,"./tr":646,"./tr.js":646,"./tzl":647,"./tzl.js":647,"./tzm":648,"./tzm-latn":649,"./tzm-latn.js":649,"./tzm.js":648,"./ug-cn":650,"./ug-cn.js":650,"./uk":651,"./uk.js":651,"./ur":652,"./ur.js":652,"./uz":653,"./uz-latn":654,"./uz-latn.js":654,"./uz.js":653,"./vi":655,"./vi.js":655,"./x-pseudo":656,"./x-pseudo.js":656,"./yo":657,"./yo.js":657,"./zh-cn":658,"./zh-cn.js":658,"./zh-hk":659,"./zh-hk.js":659,"./zh-tw":660,"./zh-tw.js":660};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=1586},1587:function(e,t,n){"use strict";n.r(t);var r=n(118),o=n.n(r),i=n(661);var a,s=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gui=new i.a,this.scene=t,this.gui.add(this.scene.scene,"pause"),this.gui.add(this.scene.scene,"resume"),this.gui.add(this.scene.sound,"mute").listen(),this.gui.add(this.scene,"timeScale",.1,4).onChange((function(e){return n.scene.time.timeScale=e})),1===this.scene.runner.neuvol.options.population&&(this.controls=this.scene.input.keyboard.addKeys({up:Phaser.Input.Keyboard.KeyCodes.W,down:Phaser.Input.Keyboard.KeyCodes.S,left:Phaser.Input.Keyboard.KeyCodes.A,right:Phaser.Input.Keyboard.KeyCodes.D}),this.controls.up.on(Phaser.Input.Keyboard.Events.DOWN,(function(){return n.scene.runner.instances.forEach((function(e){return e.data.get("pacman").nextDirection=Phaser.UP}))})),this.controls.down.on(Phaser.Input.Keyboard.Events.DOWN,(function(){return n.scene.runner.instances.forEach((function(e){return e.data.get("pacman").nextDirection=Phaser.DOWN}))})),this.controls.left.on(Phaser.Input.Keyboard.Events.DOWN,(function(){return n.scene.runner.instances.forEach((function(e){return e.data.get("pacman").nextDirection=Phaser.LEFT}))})),this.controls.right.on(Phaser.Input.Keyboard.Events.DOWN,(function(){return n.scene.runner.instances.forEach((function(e){return e.data.get("pacman").nextDirection=Phaser.RIGHT}))})))},c=n(662),u=n.n(c);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=(l(a={},Phaser.UP,Phaser.DOWN),l(a,Phaser.DOWN,Phaser.UP),l(a,Phaser.LEFT,Phaser.RIGHT),l(a,Phaser.RIGHT,Phaser.LEFT),a);function f(e){return h[e]}function p(e,t){e.anims.exists(t.key)||e.anims.create(t)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(e,n,r,o,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=v(this,b(t).call(this,e.scene,n+8,r+8,"sprites",i))).nextDirection=Phaser.NONE,a.direction=Phaser.NONE,a.target=new Phaser.Math.Vector2,a.instance=e,a.name=o,a.createAnims(i),a.createEvents(n,r,i),a}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,Phaser.Physics.Arcade.Sprite),n=t,(r=[{key:"createAnims",value:function(e){}},{key:"createEvents",value:function(e,t,n){var r=this;this.instance.on("reset",(function(){r.setPosition(e+8,t+8),r.direction=r.nextDirection=Phaser.NONE,r.anims.stop(),r.setFrame(n),r.setActive(!0),r.setVisible(!0)})),this.instance.on("end",(function(){return r.setVelocity(0)}))}},{key:"createDirectionAnims",value:function(e,t){p(this.scene,{key:"".concat(e,"-right"),frames:this.scene.anims.generateFrameNumbers("sprites",{frames:t.right}),frameRate:15,repeat:Phaser.FOREVER}),p(this.scene,{key:"".concat(e,"-left"),frames:this.scene.anims.generateFrameNumbers("sprites",{frames:t.left}),frameRate:15,repeat:Phaser.FOREVER}),p(this.scene,{key:"".concat(e,"-up"),frames:this.scene.anims.generateFrameNumbers("sprites",{frames:t.up}),frameRate:15,repeat:Phaser.FOREVER}),p(this.scene,{key:"".concat(e,"-down"),frames:this.scene.anims.generateFrameNumbers("sprites",{frames:t.down}),frameRate:15,repeat:Phaser.FOREVER})}},{key:"update",value:function(){this.updateAnimation(),this.updateDirection(),this.updateVelocity(),this.updateSnap()}},{key:"updateAnimation",value:function(){this.body.velocity.x<0?this.play("".concat(this.name,"-left"),!0):this.body.velocity.x>0?this.play("".concat(this.name,"-right"),!0):this.body.velocity.y<0?this.play("".concat(this.name,"-up"),!0):this.body.velocity.y>0?this.play("".concat(this.name,"-down"),!0):(this.anims.stop(),this.anims.currentAnim&&this.anims.setCurrentFrame(this.anims.currentAnim.frames[0]))}},{key:"updateDirection",value:function(){if(this.direction!==this.nextDirection){var e=this.getOpenDirections(this.scene.map.worldToTileXY(this.x,this.y))[this.nextDirection];if(!e||-1===e.index)switch(this.nextDirection){case Phaser.RIGHT:case Phaser.LEFT:var t=8*Math.floor(this.body.center.y/8);(t-this.body.y)*(t-this.body.prev.y)<=0&&(this.direction=this.nextDirection);break;case Phaser.UP:case Phaser.DOWN:var n=8*Math.floor(this.body.center.x/8);(n-this.body.x)*(n-this.body.prev.x)<=0&&(this.direction=this.nextDirection)}}}},{key:"updateSnap",value:function(){switch(this.direction){case Phaser.UP:case Phaser.DOWN:this.setX(Phaser.Math.Snap.To(this.x,this.scene.map.tileWidth,this.scene.map.tileWidth/2));break;case Phaser.LEFT:case Phaser.RIGHT:this.setY(Phaser.Math.Snap.To(this.y,this.scene.map.tileHeight,this.scene.map.tileHeight/2))}}},{key:"updateVelocity",value:function(){var e=new Phaser.Math.Vector2(+(this.direction===Phaser.RIGHT)-+(this.direction===Phaser.LEFT),+(this.direction===Phaser.DOWN)-+(this.direction===Phaser.UP));this.body.velocity.setFromObject(e).scale(this.getSpeed())}},{key:"getSpeed",value:function(){return 50*this.scene.timeScale}},{key:"getOpenDirections",value:function(e){var t;return y(t={},Phaser.RIGHT,this.scene.map.getTileAt(e.x+1,e.y,!0)),y(t,Phaser.LEFT,this.scene.map.getTileAt(e.x-1,e.y,!0)),y(t,Phaser.UP,this.scene.map.getTileAt(e.x,e.y-1,!0)),y(t,Phaser.DOWN,this.scene.map.getTileAt(e.x,e.y+1,!0)),t}},{key:"randomNextDirection",value:function(e){var t=this.getOpenDirections(e),n=[];for(var r in t)t[r]&&-1===t[r].index&&+r!==f(this.nextDirection)&&n.push(+r);n.length&&(this.nextDirection=Phaser.Utils.Array.GetRandom(n))}},{key:"targetNextDirection",value:function(e){var t=this.getOpenDirections(e),n=this.nextDirection,r=1/0;for(var o in t)if(t[o]&&-1===t[o].index&&+o!==f(this.nextDirection)){var i=Phaser.Math.Distance.Squared(t[o].x,t[o].y,this.target.x,this.target.y);i<r&&(n=+o,r=i)}this.nextDirection=n}}])&&m(n.prototype,r),o&&m(n,o),t}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e,t,n){return(k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=D(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=function(e){function t(e,n,r,o,i,a){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(s=P(this,D(t).call(this,e,n,r,o,a))).home=new Phaser.Math.Vector2(i.homeX,i.homeY),s.setDataEnabled(),s}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),n=t,(r=[{key:"createAnims",value:function(e){this.createDirectionAnims(this.name,{right:[e,e+1],left:[e+2,e+3],up:[e+4,e+5],down:[e+6,e+7]}),p(this.scene,{key:"ghost-fright",frames:this.scene.anims.generateFrameNumbers("sprites",{frames:[64,65,64,65,64,65,66,67,66,67,66,67]}),frameRate:15,repeat:Phaser.FOREVER}),p(this.scene,{key:"ghost-fright-quick",frames:this.scene.anims.generateFrameNumbers("sprites",{frames:[64,65,66,67]}),frameRate:15,repeat:Phaser.FOREVER})}},{key:"createEvents",value:function(e,n,r){var o=this;k(D(t.prototype),"createEvents",this).call(this,e,n,r),this.instance.on("reset",(function(){o.setData("home",!0),o.setData("mode",!0),o.setData("fright",0),o.setData("dead",!1),o.prevTile=null})),this.instance.on("ghostModeChange",(function(e){o.reverse(),o.setData("mode",e)})),this.instance.on("pacmanEatPellet",(function(e,t){})),this.instance.on("ghostLeave",(function(e){o.getData("home")&&!e.left&&(o.setData("home",!1),e.left=!0)})),this.instance.on("end",(function(){o.setActive(!1),o.scene.time.delayedCall(1e3,(function(){return o.setVisible(!1)}))})),this.on("changedata-home",(function(e,t){t||o.setPosition(112,116)}))}},{key:"update",value:function(){var e=this.scene.map.worldToTileXY(this.x,this.y);this.prevTile&&e.equals(this.prevTile)||(this.getData("dead")&&(14!==e.y||13!==e.x&&14!==e.x||13!==this.prevTile.x&&14!==this.prevTile.x||this.setData("dead",!1)),this.updateNextDirection(e),this.prevTile=e),k(D(t.prototype),"update",this).call(this)}},{key:"updateNextDirection",value:function(e){this.getData("dead")?this.target.set(13,14):this.getData("mode")?this.target.setFromObject(this.home):this.updateTarget(),this.getData("dead")||!this.getData("fright")?this.targetNextDirection(e):this.randomNextDirection(e)}},{key:"updateTarget",value:function(){this.target.setFromObject(this.home)}},{key:"updateAnimation",value:function(){if(this.getData("dead"))switch(this.anims.stop(),this.direction){case Phaser.LEFT:this.setFrame(78);break;case Phaser.RIGHT:this.setFrame(79);break;case Phaser.UP:this.setFrame(80);break;case Phaser.DOWN:this.setFrame(81)}else this.getData("fright")?this.play("ghost-fright".concat(2===this.getData("fright")?"":"-quick"),!0):k(D(t.prototype),"updateAnimation",this).call(this)}},{key:"updateVelocity",value:function(){this.getData("home")?this.setVelocity(0):k(D(t.prototype),"updateVelocity",this).call(this)}},{key:"updateSnap",value:function(){this.getData("home")||this.getData("dead")||k(D(t.prototype),"updateSnap",this).call(this)}},{key:"reverse",value:function(){this.nextDirection=f(this.direction),this.prevTile=null}},{key:"getSpeed",value:function(){return this.getData("dead")?2*k(D(t.prototype),"getSpeed",this).call(this):.8*k(D(t.prototype),"getSpeed",this).call(this)}}])&&O(n.prototype,r),o&&O(n,o),t}(j);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e,t,n){return(R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var N=function(e){function t(e,n,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_(this,C(t).call(this,e,n,r,"blinky",o,56))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,e),n=t,(r=[{key:"createEvents",value:function(e,n,r){var o=this;R(C(t.prototype),"createEvents",this).call(this,e,n,r),this.instance.on("reset",(function(){return o.setData("home",!1)}))}},{key:"updateTarget",value:function(){var e=this.instance.getData("pacman");this.target.setFromObject(this.scene.map.worldToTileXY(e.x,e.y))}}])&&x(n.prototype,r),o&&x(n,o),t}(T);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e,t,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=function(e){function t(e,n,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),F(this,H(t).call(this,e,n,r,"clyde",o,98))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,e),n=t,(r=[{key:"createEvents",value:function(e,n,r){var o=this;I(H(t.prototype),"createEvents",this).call(this,e,n,r),this.instance.on("pacmanEatPellet",(function(e){o.getData("home")&&e<=184&&o.setData("home",!1)}))}},{key:"updateTarget",value:function(){var e=this.instance.getData("pacman"),t=this.scene.map.worldToTileXY(e.x,e.y),n=this.scene.map.worldToTileXY(e.x,e.y);Phaser.Math.Distance.Squared(n.x,n.y,t.x,t.y)>64?this.target.setFromObject(t):this.target.setFromObject(this.home)}}])&&G(n.prototype,r),o&&G(n,o),t}(T);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X(e,t,n){return(X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=q(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){function t(e,n,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),W(this,q(t).call(this,e,n,r,"inky",o,84))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(t,e),n=t,(r=[{key:"createEvents",value:function(e,n,r){var o=this;X(q(t.prototype),"createEvents",this).call(this,e,n,r),this.instance.on("pacmanEatPellet",(function(e){o.getData("home")&&e<=214&&o.setData("home",!1)}))}},{key:"updateTarget",value:function(){var e=this.instance.getData("pacman"),t=this.instance.getData("blinky"),n=new Phaser.Math.Vector2(+(e.direction===Phaser.RIGHT)-+(e.direction===Phaser.LEFT),+(e.direction===Phaser.DOWN)-+(e.direction===Phaser.UP));this.target.setFromObject(this.scene.map.worldToTileXY(e.x,e.y).add(n.scale(2)).scale(2).subtract(this.scene.map.worldToTileXY(t.x,t.y)))}}])&&V(n.prototype,r),o&&V(n,o),t}(T);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e,t,n){return(Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var te=function(e){function t(e,n,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Q(this,$(t).call(this,e,n,r,"pinky",o,70))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(t,e),n=t,(r=[{key:"createEvents",value:function(e,n,r){var o=this;Z($(t.prototype),"createEvents",this).call(this,e,n,r),this.instance.on("reset",(function(){return o.scene.time.delayedCall(500,(function(){return o.setData("home",!1)}))}))}},{key:"updateTarget",value:function(){var e=this.instance.getData("pacman"),t=new Phaser.Math.Vector2(+(e.direction===Phaser.RIGHT)-+(e.direction===Phaser.LEFT),+(e.direction===Phaser.DOWN)-+(e.direction===Phaser.UP));this.target.setFromObject(t).scale(4).add(this.scene.map.worldToTileXY(e.x,e.y))}}])&&B(n.prototype,r),o&&B(n,o),t}(T);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e,t,n){return(ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=oe(this,ae(t).call(this,e,n,r,"pacman",2))).eatSound=o.scene.sound.add("eating"),o.deathSound=o.scene.sound.add("miss",{volume:.5}),o.eatSound.addMarker({name:"play",start:1.2,duration:.24,config:{volume:.5}}),o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(t,e),n=t,(r=[{key:"createAnims",value:function(){this.createDirectionAnims("pacman",{right:[1,0,1,2],left:[15,14,15,2],up:[29,28,29,2],down:[43,42,43,2]}),p(this.scene,{key:"pacman-death",frames:this.scene.anims.generateFrameNumbers("sprites",{start:2,end:13}),frameRate:10,repeat:0,hideOnComplete:!0})}},{key:"createEvents",value:function(e,n,r){var o=this;ie(ae(t.prototype),"createEvents",this).call(this,e,n,r),this.instance.on("pacmanEatPellet",(function(e){e||o.instance.emit("end"),0===o.instance.index&&(o.eatSound.isPlaying||o.eatSound.play("play"))})),this.instance.on("reset",(function(){return o.prevTile=null})),this.instance.on("death",(function(){o.anims.stop(),o.scene.time.delayedCall(1e3,(function(){o.play("pacman-death"),o.instance.index||o.deathSound.play()}))}))}},{key:"update",value:function(){if(!this.instance.getData("end")){var e=this.scene.map.getLayer("pellets").tilemapLayer,n=this.scene.map.worldToTileXY(this.x,this.y);if(!this.prevTile||!n.equals(this.prevTile)){if(e.getTileAt(n.x,n.y,!0)){var r=this.instance.pellets[28*n.y+n.x];if(-1!==r){this.instance.index||e.removeTileAt(n.x,n.y),this.instance.pellets[28*n.y+n.x]=-1;var o=this.instance.getData("dots")-1;this.instance.setData("dots",o),this.instance.emit("pacmanEatPellet",o,46!==r)}}1!==this.scene.runner.neuvol.options.population&&(this.target=this.scene.runner.generate(this.instance.index),this.targetNextDirection(n)),this.prevTile=n}1!==this.scene.runner.neuvol.options.population&&(this.scene.debugGraphic.lineStyle(1,this.instance.index?16777215:65280,this.instance.index?.25:1),this.scene.debugGraphic.lineBetween(this.x,this.y,8*this.target.x+4,8*this.target.y+4)),ie(ae(t.prototype),"update",this).call(this)}}}])&&re(n.prototype,r),o&&re(n,o),t}(j);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ve=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=de(this,ye(t).call(this,e,"instance"))).pellets=fe(n.scene.data.get("dotTiles")),n.entities=n.scene.physics.add.group({runChildUpdate:!0}),n.ghosts=n.scene.add.group(),n.setDataEnabled(),n.index=r,n.addEntitiesFromLayers(),n.scene.physics.add.collider(n.scene.map.getLayer().tilemapLayer,n.entities),n.scene.physics.add.overlap(n.ghosts,n.getData("pacman"),(function(e,t){n.getData("end")||n.scene.map.worldToTileXY(e.x,e.y).equals(n.scene.map.worldToTileXY(t.x,t.y))&&(e.getData("fright")?(e.setData("fright",0),e.setData("dead",!0)):e.getData("dead")||n.emit("end"))})),n.createEvents(),n.setData("end",!0),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,Phaser.GameObjects.GameObject),n=t,(r=[{key:"addEntitiesFromLayers",value:function(){var e=this;this.scene.map.getObjectLayer("entities").objects.forEach((function(t){var n=1===e.scene.runner.neuvol.options.population?{pacman:ce,blinky:N,pinky:te,inky:Y,clyde:L}[t.name]:{pacman:ce,blinky:N}[t.name];if(n){var r=new n(e,t.x,t.y,t.properties&&t.properties.reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,he({},t.name,t.value))}),{}));e.entities.add(r,!0),r.setSize(8,8),e.index&&r.setAlpha(.25),e.setData(t.name,r),"ghost"===t.type&&e.ghosts.add(r)}}))}},{key:"createEvents",value:function(){var e=this;this.on("pacmanEatPellet",(function(){++e.score,e.setGhostTimer(),e.setIdleTimer()})),this.on("reset",(function(){e.setData("dots",244),[7,20,7,20,5,20,5].reduce((function(t,n,r){return t+=n,e.scene.time.delayedCall(1e3*t,(function(){return e.emit("ghostModeChange",r%2==1)})),t}),0),e.pellets.forEach((function(t,n){var r=e.scene.data.get("dotTiles")[n];r&&(e.pellets[n]=r)})),e.setGhostTimer(),e.setIdleTimer(),e.score=0,e.setData("end",!1)})),this.on("end",(function(){e.getData("end")||(e.setData("end",!0),e.emit("death"))}))}},{key:"update",value:function(){this.scene.physics.world.wrap(this.entities,0)}},{key:"setGhostTimer",value:function(){var e=this;this.ghostTimer&&this.ghostTimer.remove(),this.ghostTimer=this.scene.time.delayedCall(4500,(function(){var t={left:!1};e.emit("ghostLeave",t),t.left&&e.setGhostTimer()}))}},{key:"setIdleTimer",value:function(){var e=this;this.idleTimer&&this.idleTimer.remove(),this.idleTimer=this.scene.time.delayedCall(15e3,(function(){return e.emit("end")}))}}])&&pe(n.prototype,r),o&&pe(n,o),t}();function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ge=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.genomes=[],this.neat=t}var t,n,r;return t=e,(n=[{key:"addGenome",value:function(e){var t;for(t=0;t<this.genomes.length;t++)if(this.neat.options.scoreSort<0){if(e.score>this.genomes[t].score)break}else if(e.score<this.genomes[t].score)break;this.genomes.splice(t,0,e)}},{key:"breed",value:function(e,t,n){for(var r=[],o=0;o<n;o++){var i=JSON.parse(JSON.stringify(e));for(var a in t.network.weights)Math.random()<=.5&&(i.network.weights[a]=t.network.weights[a]);for(var s in i.network.weights)Math.random()<=this.neat.options.mutationRate&&(i.network.weights[s]+=Math.random()*this.neat.options.mutationRange*2-this.neat.options.mutationRange);r.push(i)}return r}},{key:"generateNextGeneration",value:function(){for(var e=[],t=0;t<Math.round(this.neat.options.elitism*this.neat.options.population);t++)e.length<this.neat.options.population&&e.push(JSON.parse(JSON.stringify(this.genomes[t].network)));for(var n=0;n<Math.round(this.neat.options.randomBehaviour*this.neat.options.population);n++){var r=JSON.parse(JSON.stringify(this.genomes[0].network));for(var o in r.weights)r.weights[o]=this.neat.options.randomClamped();e.length<this.neat.options.population&&e.push(r)}for(var i=0;;){for(var a=0;a<i;a++){var s=this.breed(this.genomes[a],this.genomes[i],this.neat.options.nbChild>0?this.neat.options.nbChild:1);for(var c in s)if(e.push(s[c].network),e.length>=this.neat.options.population)return e}++i>=this.genomes.length-1&&(i=0)}}}])&&be(t.prototype,n),r&&be(t,r),e}();function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var we=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=0,this.weights=[],this.neat=t}var t,n,r;return t=e,(n=[{key:"populate",value:function(e){this.weights=[];for(var t=0;t<e;t++)this.weights.push(this.neat.options.randomClamped())}}])&&je(t.prototype,n),r&&je(t,r),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.neurons=[],this.neat=t,this.id=n||0}var t,n,r;return t=e,(n=[{key:"populate",value:function(e,t){this.neurons=[];for(var n=0;n<e;n++){var r=new we(this.neat);r.populate(t),this.neurons.push(r)}}}])&&Oe(t.prototype,n),r&&Oe(t,r),e}();function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var De=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.layers=[],this.neat=t}var t,n,r;return t=e,(n=[{key:"perceptronGeneration",value:function(e,t,n){var r=0,o=0,i=new Pe(this.neat,r);for(var a in i.populate(e,o),o=e,this.layers.push(i),r++,t){var s=new Pe(this.neat,r);s.populate(t[a],o),o=t[a],this.layers.push(s),r++}(i=new Pe(this.neat,r)).populate(n,o),this.layers.push(i)}},{key:"getSave",value:function(){var e={neurons:[],weights:[]};for(var t in this.layers)for(var n in e.neurons.push(this.layers[t].neurons.length),this.layers[t].neurons)for(var r in this.layers[t].neurons[n].weights)e.weights.push(this.layers[t].neurons[n].weights[r]);return e}},{key:"setSave",value:function(e){var t=0,n=0,r=0;for(var o in this.layers=[],e.neurons){var i=new Pe(this.neat,n);for(var a in i.populate(e.neurons[o],t),i.neurons)for(var s in i.neurons[a].weights)i.neurons[a].weights[s]=e.weights[r],r++;t=e.neurons[o],n++,this.layers.push(i)}}},{key:"compute",value:function(e){for(var t in e)this.layers[0]&&this.layers[0].neurons[t]&&(this.layers[0].neurons[t].value=e[t]);for(var n=this.layers[0],r=1;r<this.layers.length;r++){for(var o in this.layers[r].neurons){var i=0;for(var a in n.neurons)i+=n.neurons[a].value*this.layers[r].neurons[o].weights[a];this.layers[r].neurons[o].value=this.neat.options.activation(i)}n=this.layers[r]}var s=[],c=this.layers[this.layers.length-1];for(var u in c.neurons)s.push(c.neurons[u].value);return s}}])&&ke(t.prototype,n),r&&ke(t,r),e}();function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Te=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.generations=[],this.currentGeneration=new ge(this.neat),this.neat=t}var t,n,r;return t=e,(n=[{key:"firstGeneration",value:function(e,t,n){for(var r=[],o=0;o<this.neat.options.population;o++){var i=new De(this.neat);i.perceptronGeneration(this.neat.options.network[0],this.neat.options.network[1],this.neat.options.network[2]),r.push(i.getSave())}return this.generations.push(new ge(this.neat)),r}},{key:"nextGeneration",value:function(){if(0==this.generations.length)return!1;var e=this.generations[this.generations.length-1].generateNextGeneration();return this.generations.push(new ge(this.neat)),e}},{key:"addGenome",value:function(e){return 0!=this.generations.length&&this.generations[this.generations.length-1].addGenome(e)}}])&&Ee(t.prototype,n),r&&Ee(t,r),e}();var Se=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.score=t||0,this.network=n||null};function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ce=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={activation:function(e){var t=-e;return 1/(1+Math.exp(t))},randomClamped:function(){return 2*Math.random()-1},network:[1,[1],1],population:50,elitism:.2,randomBehaviour:.2,mutationRate:.1,mutationRange:.5,historic:0,lowHistoric:!1,scoreSort:-1,nbChild:1},this.generations=new Te(this),this.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){_e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.options,{},t)}var t,n,r;return t=e,(n=[{key:"restart",value:function(){this.generations=new Te(this)}},{key:"nextGeneration",value:function(){var e=0==this.generations.generations.length?this.generations.firstGeneration():this.generations.nextGeneration(),t=[];for(var n in e){var r=new De(this);r.setSave(e[n]),t.push(r)}if(this.options.lowHistoric&&this.generations.generations.length>=2){var o=this.generations.generations[this.generations.generations.length-2].genomes;for(var i in o)delete o[i].network}return-1!=this.options.historic&&this.generations.generations.length>this.options.historic+1&&this.generations.generations.splice(0,this.generations.generations.length-(this.options.historic+1)),t}},{key:"networkScore",value:function(e,t){this.generations.addGenome(new Se(t,e.getSave()))}}])&&Re(t.prototype,n),r&&Re(t,r),e}(),Ae=n(663),Ne=n.n(Ae);function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ge=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.runner=t,this.chartData={labels:[],datasets:[{label:"min",fill:!1,backgroundColor:"red",borderColor:"red",data:[]},{label:"avg",fill:!1,backgroundColor:"blue",borderColor:"blue",data:[]},{label:"max",fill:!1,backgroundColor:"green",borderColor:"green",data:[]}]},this.chart=new Ne.a("chart",{type:"line",data:this.chartData,options:{aspectRatio:1,title:{display:!0,text:"NEAT Performance"},tooltips:{mode:"index",intersect:!1},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Generation"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Score"}}]}}})}var t,n,r;return t=e,(n=[{key:"addPoint",value:function(e,t,n,r){this.keepSameSizePush(this.chartData.labels,e.toString()),this.keepSameSizePush(this.chartData.datasets[0].data,t),this.keepSameSizePush(this.chartData.datasets[1].data,n),this.keepSameSizePush(this.chartData.datasets[2].data,r),this.chart.update()}},{key:"keepSameSizePush",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;e.push(t)>n&&e.shift()}}])&&Me(t.prototype,n),r&&Me(t,r),e}();function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ie=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.neuvol=new Ce({population:200,mutationRange:.8,mutationRate:.2,network:[8,[10],2]}),this.instances=[],this.generation=0,this.alive=0,this.scene=t,this.scene.runner=this,this.generationText=this.scene.add.text(0,0,"gen: "),this.aliveText=this.scene.add.text(85,0,"alive: ");var r=new u.a;r.showPanel(1),document.body.appendChild(r.dom),this.scene.game.events.on(Phaser.Core.Events.PRE_STEP,(function(){return r.begin()})),this.scene.game.events.on(Phaser.Core.Events.POST_RENDER,(function(){return r.end()}));for(var o=new Ge(this),i=[],a=function(e){var t=new ve(n.scene,e);n.instances.push(t),t.on("death",(function(){n.aliveText.setText("alive: ".concat(--n.alive,"/").concat(n.neuvol.options.population)),1!==n.neuvol.options.population&&(i[e]=t.score,n.neuvol.networkScore(n.gen[e],i[e])),n.alive||(o.addPoint(n.generation,Math.min.apply(Math,i),i.reduce((function(e,t){return e+t}),0)/i.length,Math.max.apply(Math,i)),n.scene.time.delayedCall(3e3,(function(){return n.start()})))}))},s=0;s<this.neuvol.options.population;++s)a(s);this.start()}var t,n,r;return t=e,(n=[{key:"start",value:function(){this.alive=this.neuvol.options.population,this.gen&&1===this.alive||(this.gen=this.neuvol.nextGeneration()),this.generationText.setText("gen: ".concat(++this.generation)),this.aliveText.setText("alive: ".concat(this.alive,"/").concat(this.neuvol.options.population)),this.scene.events.emit("reset"),this.instances.forEach((function(e){return e.emit("reset")}))}},{key:"generate",value:function(e){var t=this.instances[e],n=[0,0,0,0];t.pellets.forEach((function(e,t){-1!==e&&(t<504?n[t%28<14?0:1]++:n[t%28<14?2:3]++)}));var r=t.getData("pacman").body.position,o=t.getData("blinky").body.position,i=[n[0]/56,n[1]/56,n[2]/66,n[3]/66,r.x/224,r.y/288,o.x/224,o.y/288],a=this.gen[e].compute(i);return new Phaser.Math.Vector2(Math.floor(28*a[0]),Math.floor(36*a[1]))}}])&&Fe(t.prototype,n),r&&Fe(t,r),e}();function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var We=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Le(r,(n=r=Le(this,(e=Ue(t)).call.apply(e,[this].concat(i))),r.timeScale=1,n))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(t,Phaser.Scene),n=t,(r=[{key:"preload",value:function(){this.load.image("tiles","assets/tilemap/maze.png"),this.load.tilemapTiledJSON("map","assets/tilemap/maze.json"),this.load.spritesheet("sprites","assets/sprites.png",{frameWidth:16,frameHeight:16}),this.load.audio("eating","assets/sounds/eating.mp3"),this.load.audio("miss","assets/sounds/miss.mp3")}},{key:"create",value:function(){var e=this;window.Phaser=Phaser,this.map=this.add.tilemap("map");var t=this.map.addTilesetImage("maze","tiles"),n=this.map.createStaticLayer("maze",t);n.setCollisionByProperty({collides:!0});var r=this.map.createDynamicLayer("pellets",t),o=[];r.forEachTile((function(e,t){return o[t]=e.index})),this.data.set("dotTiles",o),this.map.setLayer(n),this.events.on("reset",(function(){e.time.removeAllEvents(),r.forEachTile((function(t,n){e.data.get("dotTiles")[n]&&r.putTileAt(e.data.get("dotTiles")[n],t.x,t.y)})),e.startTime=e.time.now})),this.sound.pauseOnBlur=!1,this.debugGraphic=this.add.graphics(),this.debugGraphic.setDepth(Number.MAX_VALUE),this.events.on("preupdate",(function(){return e.debugGraphic.clear()})),new Ie(this),new s(this)}},{key:"update",value:function(){this.runner.instances.forEach((function(e){return e.active&&e.update()}))}}])&&ze(n.prototype,r),o&&ze(n,o),t}();document.addEventListener("DOMContentLoaded",(function(){new o.a.Game({type:o.a.AUTO,render:{pixelArt:!0},scale:{mode:o.a.Scale.FIT,parent:"root",autoCenter:o.a.Scale.CENTER_BOTH,width:224,height:288},physics:{default:"arcade",arcade:{tileBias:4}},scene:We})}))},664:function(e,t,n){e.exports=n(1587)}});